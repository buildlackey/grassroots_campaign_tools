<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
      }
      label {
        display: block;
        margin-top: 10px;
        font-weight: bold;
      }
      input, select {
        width: 100%;
        padding: 6px;
        margin-top: 4px;
        box-sizing: border-box;
      }
      #error {
        color: red;
        margin-top: 10px;
        display: none;
      }
      button {
        margin-top: 20px;
      }
    </style>
  </head>
  <body>
    <label for="address">Enter The Address:</label>
    <input type="text" id="address" placeholder="Start typing..." autocomplete="off">

    <label for="distance">Max Distance (miles):</label>
    <input type="range" id="distance" min="1" max="100" value="10" oninput="updateSlider(this.value)">
    <div>Selected: <span id="distanceVal">10</span> miles</div>

    <div id="error">Address not found. Please try again.</div>

    <button onclick="submitForm()">Filter</button>

    <script>
      function updateSlider(val) {
        document.getElementById("distanceVal").innerText = val;
      }

      function submitForm() {
        const addr = document.getElementById("address").value.trim();
        const dist = document.getElementById("distance").value;

        if (!addr) {
          showError("Please enter a valid address.");
          return;
        }

        google.script.run.withSuccessHandler(() => {
          google.script.host.close();
        }).withFailureHandler(err => {
          showError("Something went wrong: " + err.message);
        }).dummyHandler(addr, dist);
      }

      function showError(msg) {
        const e = document.getElementById("error");
        e.innerText = msg;
        e.style.display = "block";
      }
    </script>
  </body>
</html>
