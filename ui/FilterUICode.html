<script>
function submitForm() {
  const form = document.getElementById('myForm');
  const nameInput = document.getElementById('name');
  const emailInput = document.getElementById('email');

  // Manual validation
  if (!nameInput.value.trim()) {
    alert('Please enter your name');
    nameInput.focus();
    return;
  }

  if (!emailInput.value.trim() || !emailInput.validity.valid) {
    alert('Please enter a valid email');
    emailInput.focus();
    return;
  }

  const formData = {
    name: nameInput.value.trim(),
    email: emailInput.value.trim()
  };
  
  google.script.run
    .withSuccessHandler(function(response) {
      if (response.success) {
        google.script.host.close();
      } else {
        alert('Error: ' + response.message);
      }
    })
    .withFailureHandler(function(error) {
      alert('Server error: ' + error.message);
    })
    .processForm(formData);
}
</script>
